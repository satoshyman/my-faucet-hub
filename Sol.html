<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Solana Platinum V8.6 - SolClaimer</title>
    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* تغيير الهوية اللونية إلى البنفسجي والنيون (Solana) */
        :root { 
            --bg: #050505; 
            --card: #111; 
            --primary: #9945FF; 
            --secondary: #14F195; 
            --gray: #a0a0a0; 
            --line: #222; 
            --glass: rgba(255, 255, 255, 0.05); 
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { background: var(--bg); color: #fff; font-family: 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }

        /* زر الرجوع الذكي */
        .back-home-btn { 
            position: fixed; 
            top: 15px; 
            left: 15px; 
            width: 40px; 
            height: 40px; 
            background: var(--glass); 
            border: 1px solid var(--line); 
            border-radius: 12px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: var(--primary); 
            text-decoration: none; 
            z-index: 1000; 
            backdrop-filter: blur(5px); 
            transition: 0.3s;
        }
        .back-home-btn:active { transform: scale(0.9); }

        /* ستايل النوافذ المنبثقة المعتمد */
        .swal2-popup { border-radius: 25px !important; background: #111 !important; border: 1px solid var(--primary) !important; color: #fff !important; }
        .swal2-title { color: var(--primary) !important; }
        .swal2-confirm { background: var(--primary) !important; color: #fff !important; border-radius: 12px !important; font-weight: bold !important; }

        .ad-zone-top { width: 100%; height: 80px; display: flex; align-items: center; justify-content: center; z-index: 10; padding-top: 10px; }
        .main-content { flex: 1; display: flex; align-items: center; justify-content: center; padding: 0 20px; position: relative; bottom: 15px; }
        .page-view { width: 100%; max-width: 420px; display: none; flex-direction: column; }
        .page-view.active { display: flex; animation: slideUp 0.4s ease-out; }

        .card { background: var(--card); border-radius: 35px; padding: 25px 20px; border: 1px solid var(--line); text-align: center; width: 100%; box-shadow: 0 25px 50px rgba(0,0,0,0.9); position: relative; }
        .bal-val { font-size: 3rem; font-weight: 900; color: var(--primary); margin: 5px 0; font-family: 'Courier New', monospace; text-shadow: 0 0 15px rgba(153, 69, 255, 0.3); }
        
        .btn-main { width: 100%; padding: 18px; border-radius: 20px; border: none; background: linear-gradient(90deg, var(--primary), var(--secondary)); color: #fff; font-size: 1.1rem; font-weight: 800; cursor: pointer; transition: 0.3s; margin-top: 15px; box-shadow: 0 5px 15px rgba(153, 69, 255, 0.2); }
        .btn-main:active { transform: scale(0.97); }
        .btn-main:disabled { opacity: 0.2; filter: grayscale(1); }

        .v-input { width: 100%; padding: 16px; background: #000; border: 1px solid #333; color: #fff; border-radius: 20px; margin-bottom: 12px; text-align: center; font-size: 1rem; transition: 0.3s; }
        .v-input:focus { border-color: var(--primary); box-shadow: 0 0 10px rgba(153, 69, 255, 0.1); }

        .grid-info { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
        .info-item { background: var(--glass); padding: 12px; border-radius: 18px; border: 1px solid #222; }
        .info-label { display: block; font-size: 0.65rem; color: var(--gray); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px; }
        .info-value { display: block; font-size: 0.9rem; font-weight: bold; color: var(--secondary); }

        .fpay-banner { background: linear-gradient(135deg, #1a1a1a 0%, #000 100%); border: 1px dashed var(--primary); border-radius: 20px; padding: 15px; margin-top: 15px; display: flex; align-items: center; justify-content: space-between; }
        .btn-reg { background: var(--primary); color: #fff; padding: 8px 14px; border-radius: 10px; text-decoration: none; font-size: 0.75rem; font-weight: bold; }

        .nav-bot { height: 95px; background: #000; display: flex; border-top: 1px solid var(--line); padding-bottom: 25px; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--gray); cursor: pointer; font-size: 0.8rem; transition: 0.3s; }
        .nav-item.active { color: var(--primary); }
        .nav-item i { font-size: 1.5rem; margin-bottom: 6px; }

        .smc-panel { position: fixed; inset: 0; background: #000; z-index: 9999; display: none; padding: 25px; overflow-y: auto; }
        #timer-text { font-size: 2.5rem; font-weight: 900; margin: 15px 0; color: var(--primary); }
        .p-bar-bg { height: 8px; background: #222; border-radius: 10px; overflow: hidden; margin-bottom: 20px; width: 80%; margin-left: 10%; }
        #p-bar { height: 100%; background: linear-gradient(90deg, var(--primary), var(--secondary)); width: 0%; transition: 1s linear; }
        .hidden { display: none !important; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<a href="index.html" class="back-home-btn">
    <i class="fas fa-chevron-left"></i>
</a>

<div class="ad-zone-top" id="ad-top-slot"></div>

<div class="main-content">
    <div id="p-home" class="page-view active">
        <div class="card">
            <img src="https://cryptologos.cc/logos/solana-sol-logo.png" style="width:65px; cursor:pointer;" id="smc-trigger">
            <div style="color:var(--gray); font-size: 0.75rem; margin-top:12px; letter-spacing: 2px;">AVAILABLE SOLANA</div>
            <div id="bal-display" class="bal-val">0.00000000</div>
            
            <div id="claim-area">
                <div style="display:flex; justify-content:center; margin:20px 0;"><div class="h-captcha" data-sitekey="50e831e4-919a-4c16-98ce-deaac51632a8" data-callback="onCap" data-theme="dark"></div></div>
                <button id="btn-claim" class="btn-main" disabled onclick="doClaim()">CLAIM SOL ⚡</button>
            </div>

            <div id="wait-area" class="hidden">
                <div id="timer-text">00:00</div>
                <div class="p-bar-bg"><div id="p-bar"></div></div>
                <p style="color:var(--gray); font-size:0.8rem;">Processing next block...</p>
            </div>
        </div>
    </div>

    <div id="p-wallet" class="page-view">
        <div class="card">
            <h3 style="margin: 0 0 20px 0; color:var(--primary); letter-spacing: 1px;">WITHDRAW SOL</h3>
            <div class="grid-info">
                <div class="info-item"><span class="info-label">MINIMUM</span><span class="info-value" id="min-txt">0.0001</span></div>
                <div class="info-item"><span class="info-label">NETWORK</span><span class="info-value" style="color:var(--secondary)">SOL-FP</span></div>
            </div>
            <input type="text" id="w-email" placeholder="FaucetPay Email Address" class="v-input">
            <input type="number" id="w-amt" placeholder="Amount (SOL)" class="v-input">
            <button class="btn-main" onclick="doWithdraw()">WITHDRAW NOW</button>
            
            <div class="fpay-banner">
                <div style="text-align:left;">
                    <div style="font-size:0.8rem; font-weight:bold;">No Wallet?</div>
                    <div style="font-size:0.65rem; color:var(--gray);">Create FaucetPay account</div>
                </div>
                <a href="https://faucetpay.io/?r=1306122" target="_blank" class="btn-reg">REGISTER</a>
            </div>
        </div>
    </div>

    <div id="p-refs" class="page-view">
        <div class="card">
            <h3 style="margin: 0 0 20px 0; color:var(--primary); letter-spacing: 1px;">SOL AFFILIATE</h3>
            <div class="grid-info">
                <div class="info-item"><span class="info-label">COMMISSION</span><span class="info-value">10% EACH CLAIM</span></div>
                <div class="info-item"><span class="info-label">JOIN BONUS</span><span class="info-value" id="ref-bonus-val">0.000005</span></div>
                <div class="info-item"><span class="info-label">TOTAL REFS</span><span class="info-value" id="ref-count">0</span></div>
                <div class="info-item"><span class="info-label">SYSTEM</span><span class="info-value">INSTANT</span></div>
            </div>
            <input type="text" id="ref-link" readonly class="v-input" style="color:var(--primary); border: 1px dashed var(--primary); background: rgba(153,69,255,0.05);">
            <button class="btn-main" onclick="copyRef()">COPY LINK</button>
        </div>
    </div>
</div>

<div id="smc-ui" class="smc-panel">
    <h2 style="color:var(--primary)">ADMIN SOL V8.6</h2>
    <label>Ad HTML Code:</label><textarea id="cfg-ad" class="v-input" style="height:80px; text-align:left;"></textarea>
    <label>FP API Key:</label><input type="text" id="cfg-api" class="v-input">
    <label>SOL Reward:</label><input type="number" id="cfg-reward" class="v-input" step="0.000001">
    <label>Ref Bonus:</label><input type="number" id="cfg-ref-bonus" class="v-input" step="0.000001">
    <label>Wait (Min):</label><input type="number" id="cfg-wait" class="v-input">
    <label>Min Payout:</label><input type="number" id="cfg-min" class="v-input">
    <button class="btn-main" onclick="saveSMC()">SAVE SETTINGS</button>
    <button class="btn-main" onclick="document.getElementById('smc-ui').style.display='none'" style="background:#333; margin-top:10px;">EXIT</button>
</div>

<nav class="nav-bot">
    <div class="nav-item active" onclick="nav('home', this)"><i class="fas fa-bolt"></i>Faucet</div>
    <div class="nav-item" onclick="nav('wallet', this)"><i class="fas fa-wallet"></i>Wallet</div>
    <div class="nav-item" onclick="nav('refs', this)"><i class="fas fa-users"></i>Friends</div>
</nav>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue, update, get, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = { 
      apiKey: "AIzaSyBq1GLYT2Pmnb-SzzBtICbx2jnWveobIVo",
      authDomain: "beeclaimer-e53c7.firebaseapp.com",
      projectId: "beeclaimer-e53c7",
      storageBucket: "beeclaimer-e53c7.firebasestorage.app",
      messagingSenderId: "242649186878",
      appId: "1:242649186878:web:e4172b28e986b04522476f",
      measurementId: "G-CPJXGS2E9Z",
      databaseURL: "https://beeclaimer-e53c7-default-rtdb.firebaseio.com" 
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const tgId = window.Telegram?.WebApp?.initDataUnsafe?.user?.id || "user_test";
    const uid = "u_sol_" + tgId;
    const refBy = new URLSearchParams(window.location.search).get('start');

    let sets = { reward: 0.00001, wait: 5, min: 0.0001, api: "", adCode: "", refBonus: 0.000005 };
    let uBal = 0; let tTick;

    const userRef = ref(db, 'sol_users/' + uid);
    const configRef = ref(db, 'sol_config');

    onValue(configRef, (s) => { 
        if(s.exists()) { 
            sets = s.val(); 
            document.getElementById('min-txt').innerText = sets.min;
            document.getElementById('ref-bonus-val').innerText = sets.refBonus;
            document.getElementById('cfg-ad').value = sets.adCode || "";
            document.getElementById('cfg-api').value = sets.api || "";
            document.getElementById('cfg-reward').value = sets.reward || 0.00001;
            document.getElementById('cfg-ref-bonus').value = sets.refBonus || 0.000005;
            document.getElementById('cfg-wait').value = sets.wait || 5;
            document.getElementById('cfg-min').value = sets.min || 0.0001;
            if(sets.adCode) document.getElementById('ad-top-slot').innerHTML = sets.adCode;
        } 
    });

    onValue(userRef, async (s) => {
        if(!s.exists()) {
            await set(userRef, { balance: 0, last: 0, refCount: 0 });
            if(refBy && refBy !== tgId.toString()) {
                const bRef = ref(db, 'sol_users/u_sol_' + refBy);
                const bSnap = await get(bRef);
                if(bSnap.exists()) {
                    await update(bRef, { balance: (bSnap.val().balance||0) + parseFloat(sets.refBonus), refCount: (bSnap.val().refCount||0) + 1 });
                }
            }
        } else {
            const d = s.val(); uBal = d.balance || 0;
            document.getElementById('bal-display').innerText = uBal.toFixed(8);
            document.getElementById('ref-count').innerText = d.refCount || 0;
            document.getElementById('ref-link').value = `https://t.me/BeeSolBot?start=${tgId}`;
            runTimer(d.last || 0);
        }
    });

    function runTimer(last) {
        clearInterval(tTick);
        const waitMs = Number(sets.wait) * 60000;
        const tick = () => {
            const diff = waitMs - (Date.now() - last);
            if(last > 0 && diff > 0) {
                document.getElementById('claim-area').classList.add('hidden');
                document.getElementById('wait-area').classList.remove('hidden');
                const m = Math.floor(diff/60000); const s = Math.floor((diff%60000)/1000);
                document.getElementById('timer-text').innerText = `${m}:${s<10?'0'+s:s}`;
                document.getElementById('p-bar').style.width = ((waitMs-diff)/waitMs*100) + "%";
            } else {
                document.getElementById('wait-area').classList.add('hidden');
                document.getElementById('claim-area').classList.remove('hidden');
                clearInterval(tTick);
            }
        };
        tick(); tTick = setInterval(tick, 1000);
    }

    window.onCap = () => { document.getElementById('btn-claim').disabled = false; };
    window.doClaim = async () => {
        document.getElementById('btn-claim').disabled = true;
        await update(userRef, { balance: uBal + parseFloat(sets.reward), last: Date.now() });
        hcaptcha.reset();
        Swal.fire({ title: 'SOL Collected!', text: `+${sets.reward} SOL added`, icon: 'success', timer: 2000, showConfirmButton: false });
    };

    window.doWithdraw = async () => {
        const email = document.getElementById('w-email').value;
        const amt = parseFloat(document.getElementById('w-amt').value);
        if(!email || isNaN(amt) || amt < sets.min || amt > uBal) return Swal.fire('Error', 'Check balance/email', 'error');
        Swal.fire({ title: 'Processing...', didOpen: () => { Swal.showLoading(); } });
        try {
            const res = await fetch('https://faucetpay.io/api/v1/send', { 
                method: 'POST', 
                body: new URLSearchParams({ api_key: sets.api, currency: 'SOL', amount: (amt*100000000).toFixed(0), to: email }) 
            });
            const r = await res.json();
            if(r.status === 200) { 
                await update(userRef, { balance: uBal - amt });
                Swal.fire('Success!', 'SOL sent to FaucetPay', 'success'); 
            } else { Swal.fire('Error', r.message, 'error'); }
        } catch(e) { Swal.fire('Error', 'Network error', 'error'); }
    };

    window.nav = (p, el) => {
        document.querySelectorAll('.page-view').forEach(v => v.classList.remove('active'));
        document.getElementById('p-'+p).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        el.classList.add('active');
    };

    window.copyRef = () => {
        const el = document.getElementById('ref-link'); el.select(); document.execCommand('copy');
        Swal.fire({ title:'Copied!', icon:'success', timer:1500, showConfirmButton: false });
    };

    window.saveSMC = async () => {
        await update(configRef, {
            adCode: document.getElementById('cfg-ad').value,
            api: document.getElementById('cfg-api').value,
            reward: parseFloat(document.getElementById('cfg-reward').value),
            refBonus: parseFloat(document.getElementById('cfg-ref-bonus').value),
            wait: parseInt(document.getElementById('cfg-wait').value),
            min: parseFloat(document.getElementById('cfg-min').value)
        });
        Swal.fire('Saved!', 'Solana Settings Updated', 'success');
    };

    let g = 0;
    document.getElementById('smc-trigger').onclick = () => { 
        g++;
        if(g>=5) { 
            Swal.fire({
                title: 'Admin Access',
                input: 'password',
                inputPlaceholder: 'Enter Password'
            }).then((r) => {
                if (r.value === "Ahmednnn3") document.getElementById('smc-ui').style.display='block';
                else if(r.value) Swal.fire('Error', 'Wrong Password', 'error');
            });
            g=0; 
        }
    };
</script>
</body>
</html>
